{"version":3,"sources":["../src/Adyen.js"],"names":["Config","production","endpoint","version","development","Specs","authorizePayment","method","path","fields","authorize3dPayment","authorize3ds2Payment","getRecurringData","disableRecurring","capture","refund","cancelOrRefund","Adyen","config","env","Object","assign","Promise","resolve","key","frontKey","generationTime","toISOString","params","_method","cfg","data","merchantAccount","_checkRequiredParams","makeRequest","inputKeys","keys","requiredRemainParams","filter","cfgField","indexOf","required","ky","field","length","Error","toString","Client"],"mappings":";;;;;;;;;AAQA;;;;AACA;;;;;;;;;;+eATA;;;;;;;;AAWA,IAAMA,SAAS;AACXC,gBAAY;AACRC,kBAAU,yCADF;AAERC,iBAAS,KAFD;AAGRF,oBAAY;AAHJ,KADD;AAMXG,iBAAa;AACTF,kBAAU,yCADD;AAETC,iBAAS,KAFA;AAGTC,qBAAa;AAHJ;AANF,CAAf;;AAaA,IAAMC,QAAQ;AACVC,sBAAkB,0BAASH,OAAT,EAAkB;AAChC,eAAO;AACHI,oBAAQ,kBADL;AAEHC,+BAAiBL,OAAjB,eAFG;AAGHM,oBAAQ;AAHL,SAAP;AAKH,KAPS;AAQVC,wBAAoB,4BAASP,OAAT,EAAkB;AAClC,eAAO;AACHI,oBAAQ,oBADL;AAEHC,+BAAiBL,OAAjB,iBAFG;AAGHM,oBAAQ;AAHL,SAAP;AAKH,KAdS;AAeVE,0BAAsB,8BAASR,OAAT,EAAkB;AACpC,eAAO;AACHI,oBAAQ,sBADL;AAEHC,+BAAiBL,OAAjB,mBAFG;AAGHM,oBAAQ;AAHL,SAAP;AAKH,KArBS;AAsBVG,sBAAkB,0BAAST,OAAT,EAAkB;AAChC,eAAO;AACHI,oBAAQ,sBADL;AAEHC,iCAAmBL,OAAnB,0BAFG;AAGHM,oBAAQ;AAHL,SAAP;AAKH,KA5BS;AA6BVI,sBAAkB,0BAASV,OAAT,EAAkB;AAChC,eAAO;AACHI,oBAAQ,kBADL;AAEHC,iCAAmBL,OAAnB,aAFG;AAGHM,oBAAQ;AAHL,SAAP;AAKH,KAnCS;AAoCVK,aAAS,iBAASX,OAAT,EAAkB;AACvB,eAAO;AACHI,oBAAQ,SADL;AAEHC,+BAAiBL,OAAjB,aAFG;AAGHM,oBAAQ;AAHL,SAAP;AAKH,KA1CS;AA2CVM,YAAQ,gBAASZ,OAAT,EAAkB;AACtB,eAAO;AACHI,oBAAQ,QADL;AAEHC,+BAAiBL,OAAjB,YAFG;AAGHM,oBAAQ;AAHL,SAAP;AAKH,KAjDS;AAkDVO,oBAAgB,wBAASb,OAAT,EAAkB;AAC9B,eAAO;AACHI,oBAAQ,gBADL;AAEHC,+BAAiBL,OAAjB,oBAFG;AAGHM,oBAAQ;AAHL,SAAP;AAKH;AAxDS,CAAd;;IA2DqBQ,K;;;AACjB,mBAAYC,MAAZ,EAAoB;AAAA;;AAChB,YAAIC,MAAMD,OAAOd,WAAP,+BAAV;AACAc,iBAASE,OAAOC,MAAP,CAAcrB,OAAOmB,GAAP,CAAd,EAA2BD,MAA3B,CAAT;;AAFgB,kHAIVA,MAJU;;AAKhB,cAAKA,MAAL,GAAcA,MAAd;AALgB;AAMnB;;;;qCAEY;AACT,mBAAOI,QAAQC,OAAR,CAAgB;AACnBC,qBAAK,KAAKN,MAAL,CAAYO,QADE;AAEnBC,gCAAgB,wBAASC,WAAT;AAFG,aAAhB,CAAP;AAIH;;;yCAEgBC,M,EAAQ;AACrB,mBAAO,KAAKC,OAAL,CAAaD,MAAb,EAAqBvB,MAAMC,gBAAN,CAAuB,KAAKY,MAAL,CAAYf,OAAnC,CAArB,CAAP;AACH;;;2CACkByB,M,EAAQ;AACvB,mBAAO,KAAKC,OAAL,CAAaD,MAAb,EAAqBvB,MAAMK,kBAAN,CAAyB,KAAKQ,MAAL,CAAYf,OAArC,CAArB,CAAP;AACH;;;6CACoByB,M,EAAQ;AACzB,mBAAO,KAAKC,OAAL,CAAaD,MAAb,EAAqBvB,MAAMM,oBAAN,CAA2B,KAAKO,MAAL,CAAYf,OAAvC,CAArB,CAAP;AACH;;;yCACgByB,M,EAAQ;AACrB,mBAAO,KAAKC,OAAL,CAAaD,MAAb,EAAqBvB,MAAMO,gBAAN,CAAuB,KAAKM,MAAL,CAAYf,OAAnC,CAArB,CAAP;AACH;;;yCACgByB,M,EAAQ;AACrB,mBAAO,KAAKC,OAAL,CAAaD,MAAb,EAAqBvB,MAAMQ,gBAAN,CAAuB,KAAKK,MAAL,CAAYf,OAAnC,CAArB,CAAP;AACH;;;gCACOyB,M,EAAQ;AACZ,mBAAO,KAAKC,OAAL,CAAaD,MAAb,EAAqBvB,MAAMS,OAAN,CAAc,KAAKI,MAAL,CAAYf,OAA1B,CAArB,CAAP;AACH;;;+BACMyB,M,EAAQ;AACX,mBAAO,KAAKC,OAAL,CAAaD,MAAb,EAAqBvB,MAAMU,MAAN,CAAa,KAAKG,MAAL,CAAYf,OAAzB,CAArB,CAAP;AACH;;;uCACcyB,M,EAAQ;AACnB,mBAAO,KAAKC,OAAL,CAAaD,MAAb,EAAqBvB,MAAMW,cAAN,CAAqB,KAAKE,MAAL,CAAYf,OAAjC,CAArB,CAAP;AACH;;;gCAEOyB,M,EAAQE,G,EAAK;AACjB,gBAAIC,OAAOX,OAAOC,MAAP,CACP;AACIW,iCAAiB,KAAKd,MAAL,CAAYc;AADjC,aADO,EAIPJ,MAJO,CAAX;;AAOAG,mBAAO,KAAKE,oBAAL,CAA0BF,IAA1B,EAAgCD,GAAhC,CAAP;AACA,mBAAO,KAAKI,WAAL,CAAiBH,IAAjB,EAAuBD,IAAItB,IAA3B,CAAP;AACH;;;6CAEoBoB,M,EAAQE,G,EAAK;AAC9B,gBAAIK,YAAYf,OAAOgB,IAAP,CAAYR,MAAZ,CAAhB;;AAEA,gBAAIS,uBAAuBjB,OAAOgB,IAAP,CAAYN,IAAIrB,MAAhB,EAAwB6B,MAAxB,CAA+B,eAAO;AAC7D,oBAAIC,WAAWT,IAAIrB,MAAJ,CAAWe,GAAX,CAAf;;AAEA,oBAAIW,UAAUK,OAAV,CAAkBhB,GAAlB,IAAyB,CAAzB,IAA8Be,SAASE,QAA3C,EAAqD;AACjD,2BAAOC,GAAGC,KAAV;AACH;AACD;AACH,aAP0B,CAA3B;;AASA,gBAAIN,qBAAqBO,MAArB,GAA8B,CAAlC,EAAqC;AACjC,uBAAO,IAAIC,KAAJ,CACH,yCACIR,qBAAqBS,QAArB,EADJ,MADG,CAAP;AAKH;;AAED,mBAAOlB,MAAP;AACH;;;;EA1E8BmB,gB;;kBAAd9B,K","file":"Adyen.js","sourcesContent":["/*\n * adyen-client\n *\n *\n * Copyright (c) 2018 Daniel Biedma Ramos\n * Licensed under the MIT license.\n */\n\nimport moment from 'moment';\nimport Client from './Client';\n\nconst Config = {\n    production: {\n        endpoint: 'https://pal-live.adyen.com/pal/servlet/',\n        version: 'v12',\n        production: true\n    },\n    development: {\n        endpoint: 'https://pal-test.adyen.com/pal/servlet/',\n        version: 'v12',\n        development: true\n    }\n};\n\nconst Specs = {\n    authorizePayment: function(version) {\n        return {\n            method: 'authorizePayment',\n            path: `Payment/${version}/authorise`,\n            fields: {}\n        };\n    },\n    authorize3dPayment: function(version) {\n        return {\n            method: 'authorize3dPayment',\n            path: `Payment/${version}/authorise3d`,\n            fields: {}\n        };\n    },\n    authorize3ds2Payment: function(version) {\n        return {\n            method: 'authorize3ds2Payment',\n            path: `Payment/${version}/authorise3ds2`,\n            fields: {}\n        };\n    },\n    getRecurringData: function(version) {\n        return {\n            method: 'listRecurringDetails',\n            path: `Recurring/${version}/listRecurringDetails`,\n            fields: {}\n        };\n    },\n    disableRecurring: function(version) {\n        return {\n            method: 'disableRecurring',\n            path: `Recurring/${version}/disable`,\n            fields: {}\n        };\n    },\n    capture: function(version) {\n        return {\n            method: 'capture',\n            path: `Payment/${version}/capture`,\n            fields: {}\n        };\n    },\n    refund: function(version) {\n        return {\n            method: 'refund',\n            path: `Payment/${version}/refund`,\n            fields: {}\n        };\n    },\n    cancelOrRefund: function(version) {\n        return {\n            method: 'cancelOrRefund',\n            path: `Payment/${version}/cancelOrRefund`,\n            fields: {}\n        };\n    }\n};\n\nexport default class Adyen extends Client {\n    constructor(config) {\n        let env = config.development ? `development` : `production`;\n        config = Object.assign(Config[env], config);\n\n        super(config);\n        this.config = config;\n    }\n\n    initCCForm() {\n        return Promise.resolve({\n            key: this.config.frontKey,\n            generationTime: moment().toISOString()\n        });\n    }\n\n    authorizePayment(params) {\n        return this._method(params, Specs.authorizePayment(this.config.version));\n    }\n    authorize3dPayment(params) {\n        return this._method(params, Specs.authorize3dPayment(this.config.version));\n    }\n    authorize3ds2Payment(params) {\n        return this._method(params, Specs.authorize3ds2Payment(this.config.version));\n    }\n    getRecurringData(params) {\n        return this._method(params, Specs.getRecurringData(this.config.version));\n    }\n    disableRecurring(params) {\n        return this._method(params, Specs.disableRecurring(this.config.version));\n    }\n    capture(params) {\n        return this._method(params, Specs.capture(this.config.version));\n    }\n    refund(params) {\n        return this._method(params, Specs.refund(this.config.version));\n    }\n    cancelOrRefund(params) {\n        return this._method(params, Specs.cancelOrRefund(this.config.version));\n    }\n\n    _method(params, cfg) {\n        let data = Object.assign(\n            {\n                merchantAccount: this.config.merchantAccount\n            },\n            params\n        );\n\n        data = this._checkRequiredParams(data, cfg);\n        return this.makeRequest(data, cfg.path);\n    }\n\n    _checkRequiredParams(params, cfg) {\n        var inputKeys = Object.keys(params);\n\n        var requiredRemainParams = Object.keys(cfg.fields).filter(key => {\n            var cfgField = cfg.fields[key];\n\n            if (inputKeys.indexOf(key) < 0 && cfgField.required) {\n                return ky.field;\n            }\n            return;\n        });\n\n        if (requiredRemainParams.length > 0) {\n            return new Error(\n                `You dont send all required params. [` +\n                    requiredRemainParams.toString() +\n                    `]`\n            );\n        }\n\n        return params;\n    }\n}\n"]}